/**
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */'use strict';var cov_1ikzxcaier=function(){var path='/Users/gurleenk/athenz_repo_new/athenz/libs/nodejs/auth_core/src/util/Crypto.js',hash='713e533cd36fa0ab7d48cc6ec91646901028a6a1',Function=function(){}.constructor,global=new Function('return this')(),gcv='__coverage__',coverageData={path:'/Users/gurleenk/athenz_repo_new/athenz/libs/nodejs/auth_core/src/util/Crypto.js',statementMap:{'0':{start:{line:16,column:13},end:{line:16,column:30}},'1':{start:{line:17,column:14},end:{line:17,column:34}},'2':{start:{line:19,column:17},end:{line:19,column:18}},'3':{start:{line:23,column:4},end:{line:29,column:5}},'4':{start:{line:24,column:17},end:{line:24,column:58}},'5':{start:{line:25,column:6},end:{line:25,column:27}},'6':{start:{line:26,column:6},end:{line:26,column:50}},'7':{start:{line:28,column:6},end:{line:28,column:50}},'8':{start:{line:33,column:4},end:{line:39,column:5}},'9':{start:{line:34,column:17},end:{line:34,column:51}},'10':{start:{line:35,column:6},end:{line:35,column:27}},'11':{start:{line:36,column:6},end:{line:36,column:51}},'12':{start:{line:38,column:6},end:{line:38,column:50}},'13':{start:{line:43,column:4},end:{line:50,column:5}},'14':{start:{line:44,column:16},end:{line:44,column:48}},'15':{start:{line:45,column:19},end:{line:45,column:55}},'16':{start:{line:46,column:6},end:{line:46,column:29}},'17':{start:{line:47,column:6},end:{line:47,column:37}},'18':{start:{line:49,column:6},end:{line:49,column:52}},'19':{start:{line:54,column:15},end:{line:54,column:45}},'20':{start:{line:55,column:4},end:{line:55,column:32}},'21':{start:{line:59,column:0},end:{line:59,column:24}}},fnMap:{'0':{name:'(anonymous_0)',decl:{start:{line:22,column:2},end:{line:22,column:3}},loc:{start:{line:22,column:37},end:{line:30,column:3}},line:22},'1':{name:'(anonymous_1)',decl:{start:{line:32,column:2},end:{line:32,column:3}},loc:{start:{line:32,column:45},end:{line:40,column:3}},line:32},'2':{name:'(anonymous_2)',decl:{start:{line:42,column:2},end:{line:42,column:3}},loc:{start:{line:42,column:58},end:{line:51,column:3}},line:42},'3':{name:'(anonymous_3)',decl:{start:{line:53,column:2},end:{line:53,column:3}},loc:{start:{line:53,column:22},end:{line:56,column:3}},line:53}},branchMap:{},s:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0},f:{'0':0,'1':0,'2':0,'3':0},b:{},_coverageSchema:'332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();var crypto=(cov_1ikzxcaier.s[0]++,require('crypto'));var ybase64=(cov_1ikzxcaier.s[1]++,require('./YBase64'));var SALT_BYTES=(cov_1ikzxcaier.s[2]++,4);class Crypto{static hmac(message,sharedSecret){cov_1ikzxcaier.f[0]++;cov_1ikzxcaier.s[3]++;try{var hmac=(cov_1ikzxcaier.s[4]++,crypto.createHmac('sha256',sharedSecret));cov_1ikzxcaier.s[5]++;hmac.update(message);cov_1ikzxcaier.s[6]++;return ybase64.ybase64Encode(hmac.digest());}catch(e){cov_1ikzxcaier.s[7]++;throw new Error('Crypto:hmac:'+e.message);}}static sign(message,key,digestAlgorithm){cov_1ikzxcaier.f[1]++;cov_1ikzxcaier.s[8]++;try{var sign=(cov_1ikzxcaier.s[9]++,crypto.createSign(digestAlgorithm));cov_1ikzxcaier.s[10]++;sign.update(message);cov_1ikzxcaier.s[11]++;return ybase64.ybase64Encode(sign.sign(key));}catch(e){cov_1ikzxcaier.s[12]++;throw new Error('Crypto:sign:'+e.message);}}static verify(message,key,signature,digestAlgorithm){cov_1ikzxcaier.f[2]++;cov_1ikzxcaier.s[13]++;try{var sig=(cov_1ikzxcaier.s[14]++,ybase64.ybase64Decode(signature));var verify=(cov_1ikzxcaier.s[15]++,crypto.createVerify(digestAlgorithm));cov_1ikzxcaier.s[16]++;verify.update(message);cov_1ikzxcaier.s[17]++;return verify.verify(key,sig);}catch(e){cov_1ikzxcaier.s[18]++;throw new Error('Crypto:verify:'+e.message);}}static randomSalt(){cov_1ikzxcaier.f[3]++;var salt=(cov_1ikzxcaier.s[19]++,crypto.randomBytes(SALT_BYTES));cov_1ikzxcaier.s[20]++;return salt.toString('hex');}}cov_1ikzxcaier.s[21]++;module.exports=Crypto;