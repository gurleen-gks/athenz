/**
 * Copyright 2016 Yahoo Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */'use strict';var cov_25t2kf09ly=function(){var path='/Users/gurleenk/athenz_repo_new/athenz/ui/src/api/domain.js',hash='68ed8b5b27ac0c3e89530bcd079407b4a6a09efb',Function=function(){}.constructor,global=new Function('return this')(),gcv='__coverage__',coverageData={path:'/Users/gurleenk/athenz_repo_new/athenz/ui/src/api/domain.js',statementMap:{'0':{start:{line:18,column:15},end:{line:18,column:38}},'1':{start:{line:20,column:0},end:{line:125,column:2}},'2':{start:{line:22,column:4},end:{line:31,column:11}},'3':{start:{line:34,column:4},end:{line:36,column:11}},'4':{start:{line:39,column:4},end:{line:46,column:11}},'5':{start:{line:49,column:4},end:{line:52,column:11}},'6':{start:{line:55,column:4},end:{line:60,column:11}},'7':{start:{line:63,column:4},end:{line:65,column:11}},'8':{start:{line:68,column:19},end:{line:68,column:20}},'9':{start:{line:69,column:20},end:{line:69,column:22}},'10':{start:{line:70,column:25},end:{line:70,column:27}},'11':{start:{line:71,column:14},end:{line:82,column:7}},'12':{start:{line:72,column:8},end:{line:81,column:9}},'13':{start:{line:73,column:21},end:{line:79,column:12}},'14':{start:{line:74,column:12},end:{line:78,column:14}},'15':{start:{line:80,column:10},end:{line:80,column:24}},'16':{start:{line:84,column:4},end:{line:92,column:7}},'17':{start:{line:88,column:6},end:{line:90,column:7}},'18':{start:{line:89,column:8},end:{line:89,column:33}},'19':{start:{line:91,column:6},end:{line:91,column:29}},'20':{start:{line:94,column:4},end:{line:103,column:7}},'21':{start:{line:99,column:6},end:{line:101,column:7}},'22':{start:{line:100,column:8},end:{line:100,column:38}},'23':{start:{line:102,column:6},end:{line:102,column:29}},'24':{start:{line:106,column:4},end:{line:113,column:7}},'25':{start:{line:107,column:19},end:{line:107,column:21}},'26':{start:{line:108,column:6},end:{line:111,column:7}},'27':{start:{line:109,column:8},end:{line:109,column:28}},'28':{start:{line:110,column:8},end:{line:110,column:32}},'29':{start:{line:112,column:6},end:{line:112,column:14}},'30':{start:{line:116,column:4},end:{line:123,column:7}},'31':{start:{line:119,column:6},end:{line:121,column:7}},'32':{start:{line:120,column:8},end:{line:120,column:58}},'33':{start:{line:122,column:6},end:{line:122,column:20}}},fnMap:{'0':{name:'(anonymous_0)',decl:{start:{line:21,column:13},end:{line:21,column:14}},loc:{start:{line:21,column:46},end:{line:32,column:3}},line:21},'1':{name:'(anonymous_1)',decl:{start:{line:33,column:16},end:{line:33,column:17}},loc:{start:{line:33,column:49},end:{line:37,column:3}},line:33},'2':{name:'(anonymous_2)',decl:{start:{line:38,column:16},end:{line:38,column:17}},loc:{start:{line:38,column:49},end:{line:47,column:3}},line:38},'3':{name:'(anonymous_3)',decl:{start:{line:48,column:19},end:{line:48,column:20}},loc:{start:{line:48,column:52},end:{line:53,column:3}},line:48},'4':{name:'(anonymous_4)',decl:{start:{line:54,column:17},end:{line:54,column:18}},loc:{start:{line:54,column:50},end:{line:61,column:3}},line:54},'5':{name:'(anonymous_5)',decl:{start:{line:62,column:20},end:{line:62,column:21}},loc:{start:{line:62,column:53},end:{line:66,column:3}},line:62},'6':{name:'(anonymous_6)',decl:{start:{line:67,column:20},end:{line:67,column:21}},loc:{start:{line:67,column:53},end:{line:104,column:3}},line:67},'7':{name:'(anonymous_7)',decl:{start:{line:71,column:14},end:{line:71,column:15}},loc:{start:{line:71,column:35},end:{line:82,column:7}},line:71},'8':{name:'(anonymous_8)',decl:{start:{line:73,column:37},end:{line:73,column:38}},loc:{start:{line:73,column:52},end:{line:79,column:11}},line:73},'9':{name:'(anonymous_9)',decl:{start:{line:87,column:4},end:{line:87,column:5}},loc:{start:{line:87,column:24},end:{line:92,column:5}},line:87},'10':{name:'(anonymous_10)',decl:{start:{line:98,column:4},end:{line:98,column:5}},loc:{start:{line:98,column:24},end:{line:103,column:5}},line:98},'11':{name:'(anonymous_11)',decl:{start:{line:105,column:19},end:{line:105,column:20}},loc:{start:{line:105,column:52},end:{line:114,column:3}},line:105},'12':{name:'(anonymous_12)',decl:{start:{line:106,column:37},end:{line:106,column:38}},loc:{start:{line:106,column:57},end:{line:113,column:5}},line:106},'13':{name:'(anonymous_13)',decl:{start:{line:115,column:23},end:{line:115,column:24}},loc:{start:{line:115,column:56},end:{line:124,column:3}},line:115},'14':{name:'(anonymous_14)',decl:{start:{line:118,column:7},end:{line:118,column:8}},loc:{start:{line:118,column:27},end:{line:123,column:5}},line:118}},branchMap:{'0':{loc:{start:{line:72,column:8},end:{line:81,column:9}},type:'if',locations:[{start:{line:72,column:8},end:{line:81,column:9}},{start:{line:72,column:8},end:{line:81,column:9}}],line:72},'1':{loc:{start:{line:88,column:6},end:{line:90,column:7}},type:'if',locations:[{start:{line:88,column:6},end:{line:90,column:7}},{start:{line:88,column:6},end:{line:90,column:7}}],line:88},'2':{loc:{start:{line:88,column:10},end:{line:88,column:43}},type:'binary-expr',locations:[{start:{line:88,column:10},end:{line:88,column:14}},{start:{line:88,column:18},end:{line:88,column:43}}],line:88},'3':{loc:{start:{line:99,column:6},end:{line:101,column:7}},type:'if',locations:[{start:{line:99,column:6},end:{line:101,column:7}},{start:{line:99,column:6},end:{line:101,column:7}}],line:99},'4':{loc:{start:{line:99,column:10},end:{line:99,column:43}},type:'binary-expr',locations:[{start:{line:99,column:10},end:{line:99,column:14}},{start:{line:99,column:18},end:{line:99,column:43}}],line:99},'5':{loc:{start:{line:108,column:6},end:{line:111,column:7}},type:'if',locations:[{start:{line:108,column:6},end:{line:111,column:7}},{start:{line:108,column:6},end:{line:111,column:7}}],line:108},'6':{loc:{start:{line:108,column:10},end:{line:108,column:43}},type:'binary-expr',locations:[{start:{line:108,column:10},end:{line:108,column:14}},{start:{line:108,column:18},end:{line:108,column:43}}],line:108},'7':{loc:{start:{line:119,column:6},end:{line:121,column:7}},type:'if',locations:[{start:{line:119,column:6},end:{line:121,column:7}},{start:{line:119,column:6},end:{line:121,column:7}}],line:119},'8':{loc:{start:{line:119,column:9},end:{line:119,column:21}},type:'binary-expr',locations:[{start:{line:119,column:9},end:{line:119,column:13}},{start:{line:119,column:17},end:{line:119,column:21}}],line:119}},s:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0,'22':0,'23':0,'24':0,'25':0,'26':0,'27':0,'28':0,'29':0,'30':0,'31':0,'32':0,'33':0},f:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0},b:{'0':[0,0],'1':[0,0],'2':[0,0],'3':[0,0],'4':[0,0],'5':[0,0],'6':[0,0],'7':[0,0],'8':[0,0]},_coverageSchema:'332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();var reqUtils=(cov_25t2kf09ly.s[0]++,require('../utils/req'));cov_25t2kf09ly.s[1]++;module.exports={addDomain:function(params,restClient,cb){cov_25t2kf09ly.f[0]++;cov_25t2kf09ly.s[2]++;restClient.postDomain({auditRef:'',detail:{auditEnabled:params.auditEnabled,name:params.name,adminUsers:params.adminUsers,// zms_server requires product id
ypmId:0}},cb);},deleteDomain:function(params,restClient,cb){cov_25t2kf09ly.f[1]++;cov_25t2kf09ly.s[3]++;restClient.deleteTopLevelDomain({name:params.name},cb);},addSubDomain:function(params,restClient,cb){cov_25t2kf09ly.f[2]++;cov_25t2kf09ly.s[4]++;restClient.postSubDomain({parent:params.parent,detail:{parent:params.parent,name:params.name,adminUsers:params.adminUsers}},cb);},deleteSubDomain:function(params,restClient,cb){cov_25t2kf09ly.f[3]++;cov_25t2kf09ly.s[5]++;restClient.deleteSubDomain({parent:params.parent,name:params.name},cb);},addUserDomain:function(params,restClient,cb){cov_25t2kf09ly.f[4]++;cov_25t2kf09ly.s[6]++;restClient.postUserDomain({name:params.name,detail:{name:params.name}},cb);},deleteUserDomain:function(params,restClient,cb){cov_25t2kf09ly.f[5]++;cov_25t2kf09ly.s[7]++;restClient.deleteUserDomain({name:params.name},cb);},fetchUserDomains:function(params,restClient,cb){cov_25t2kf09ly.f[6]++;cov_25t2kf09ly.s[11]++;var apiCount=(cov_25t2kf09ly.s[8]++,2),userDomains=(cov_25t2kf09ly.s[9]++,[]),userAdminDomains=(cov_25t2kf09ly.s[10]++,[]),apiCb=function(count,err){cov_25t2kf09ly.f[7]++;cov_25t2kf09ly.s[12]++;if(count===0){cov_25t2kf09ly.b[0][0]++;var data=(cov_25t2kf09ly.s[13]++,userDomains.map(function(name){cov_25t2kf09ly.f[8]++;cov_25t2kf09ly.s[14]++;return{name:name,type:reqUtils.getDomainDisplayLabel(reqUtils.ascertainDomainType(name).domainType),admin:userAdminDomains.indexOf(name)>-1};}));cov_25t2kf09ly.s[15]++;cb(err,data);}else{cov_25t2kf09ly.b[0][1]++;}};cov_25t2kf09ly.s[16]++;restClient.getDomainList({roleMember:params.userId},function(err,json){cov_25t2kf09ly.f[9]++;cov_25t2kf09ly.s[17]++;if((cov_25t2kf09ly.b[2][0]++,!err)&&(cov_25t2kf09ly.b[2][1]++,Array.isArray(json.names))){cov_25t2kf09ly.b[1][0]++;cov_25t2kf09ly.s[18]++;userDomains=json.names;}else{cov_25t2kf09ly.b[1][1]++;}cov_25t2kf09ly.s[19]++;apiCb(--apiCount,err);});cov_25t2kf09ly.s[20]++;restClient.getDomainList({roleMember:params.userId,roleName:'admin'},function(err,json){cov_25t2kf09ly.f[10]++;cov_25t2kf09ly.s[21]++;if((cov_25t2kf09ly.b[4][0]++,!err)&&(cov_25t2kf09ly.b[4][1]++,Array.isArray(json.names))){cov_25t2kf09ly.b[3][0]++;cov_25t2kf09ly.s[22]++;userAdminDomains=json.names;}else{cov_25t2kf09ly.b[3][1]++;}cov_25t2kf09ly.s[23]++;apiCb(--apiCount,err);});},fetchAllDomains:function(params,restClient,cb){cov_25t2kf09ly.f[11]++;cov_25t2kf09ly.s[24]++;restClient.getDomainList(params,function(err,json){cov_25t2kf09ly.f[12]++;var output=(cov_25t2kf09ly.s[25]++,[]);cov_25t2kf09ly.s[26]++;if((cov_25t2kf09ly.b[6][0]++,!err)&&(cov_25t2kf09ly.b[6][1]++,Array.isArray(json.names))){cov_25t2kf09ly.b[5][0]++;cov_25t2kf09ly.s[27]++;output=json.names;cov_25t2kf09ly.s[28]++;return cb(null,output);}else{cov_25t2kf09ly.b[5][1]++;}cov_25t2kf09ly.s[29]++;cb(err);});},fetchDomainMetadata:function(params,restClient,cb){cov_25t2kf09ly.f[13]++;cov_25t2kf09ly.s[30]++;restClient.getDomain({domain:params.domainId},function(err,data){cov_25t2kf09ly.f[14]++;cov_25t2kf09ly.s[31]++;if((cov_25t2kf09ly.b[8][0]++,!err)&&(cov_25t2kf09ly.b[8][1]++,data)){cov_25t2kf09ly.b[7][0]++;cov_25t2kf09ly.s[32]++;data.editUrl=`/athenz/domain/${data.name}/edit`;}else{cov_25t2kf09ly.b[7][1]++;}cov_25t2kf09ly.s[33]++;cb(err,data);});}};