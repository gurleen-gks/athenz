/**
 * Copyright 2016 Yahoo Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */'use strict';var cov_2hlfa71304=function(){var path='/Users/gurleenk/athenz_repo_new/athenz/ui/src/routeHandlers/role.js',hash='ed81beb6ceab97cdc571dcf1b40e8508dbc96f09',Function=function(){}.constructor,global=new Function('return this')(),gcv='__coverage__',coverageData={path:'/Users/gurleenk/athenz_repo_new/athenz/ui/src/routeHandlers/role.js',statementMap:{'0':{start:{line:18,column:16},end:{line:18,column:40}},'1':{start:{line:19,column:16},end:{line:19,column:40}},'2':{start:{line:20,column:15},end:{line:20,column:38}},'3':{start:{line:22,column:0},end:{line:79,column:2}},'4':{start:{line:24,column:4},end:{line:24,column:39}},'5':{start:{line:25,column:17},end:{line:33,column:5}},'6':{start:{line:34,column:4},end:{line:34,column:75}},'7':{start:{line:34,column:60},end:{line:34,column:73}},'8':{start:{line:35,column:4},end:{line:50,column:8}},'9':{start:{line:36,column:17},end:{line:42,column:7}},'10':{start:{line:44,column:6},end:{line:44,column:39}},'11':{start:{line:46,column:6},end:{line:49,column:9}},'12':{start:{line:53,column:17},end:{line:56,column:5}},'13':{start:{line:57,column:4},end:{line:57,column:69}},'14':{start:{line:60,column:4},end:{line:60,column:39}},'15':{start:{line:61,column:17},end:{line:66,column:5}},'16':{start:{line:68,column:4},end:{line:77,column:8}},'17':{start:{line:69,column:6},end:{line:69,column:29}},'18':{start:{line:70,column:6},end:{line:70,column:42}},'19':{start:{line:71,column:6},end:{line:71,column:39}},'20':{start:{line:73,column:6},end:{line:76,column:9}}},fnMap:{'0':{name:'(anonymous_0)',decl:{start:{line:23,column:11},end:{line:23,column:12}},loc:{start:{line:23,column:30},end:{line:51,column:3}},line:23},'1':{name:'(anonymous_1)',decl:{start:{line:34,column:50},end:{line:34,column:51}},loc:{start:{line:34,column:60},end:{line:34,column:73}},line:34},'2':{name:'(anonymous_2)',decl:{start:{line:35,column:65},end:{line:35,column:66}},loc:{start:{line:35,column:76},end:{line:50,column:5}},line:35},'3':{name:'(anonymous_3)',decl:{start:{line:52,column:14},end:{line:52,column:15}},loc:{start:{line:52,column:33},end:{line:58,column:3}},line:52},'4':{name:'(anonymous_4)',decl:{start:{line:59,column:14},end:{line:59,column:15}},loc:{start:{line:59,column:33},end:{line:78,column:3}},line:59},'5':{name:'(anonymous_5)',decl:{start:{line:68,column:65},end:{line:68,column:66}},loc:{start:{line:68,column:80},end:{line:77,column:5}},line:68}},branchMap:{'0':{loc:{start:{line:30,column:17},end:{line:30,column:68}},type:'cond-expr',locations:[{start:{line:30,column:36},end:{line:30,column:63}},{start:{line:30,column:66},end:{line:30,column:68}}],line:30}},s:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0},f:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0},b:{'0':[0,0]},_coverageSchema:'332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();var pageUtils=(cov_2hlfa71304.s[0]++,require('../utils/page'));var viewUtils=(cov_2hlfa71304.s[1]++,require('../utils/view'));var reqUtils=(cov_2hlfa71304.s[2]++,require('../utils/req'));cov_2hlfa71304.s[3]++;module.exports={addRole:function(req,res){cov_2hlfa71304.f[0]++;cov_2hlfa71304.s[4]++;pageUtils.initCommonData(req,res);var params=(cov_2hlfa71304.s[5]++,{domainName:req.params.domainId,roleName:req.body.name,role:{name:req.params.domainId+':role.'+req.body.name,members:req.body.members?(cov_2hlfa71304.b[0][0]++,req.body.members.split(',')):(cov_2hlfa71304.b[0][1]++,[]),trust:req.body['delegated-domain']}});cov_2hlfa71304.s[6]++;params.role.members=params.role.members.map(member=>{cov_2hlfa71304.f[1]++;cov_2hlfa71304.s[7]++;return member.trim();});cov_2hlfa71304.s[8]++;req.restClient.putRole(params,reqUtils.ajaxHtmlHandler(res,function(){cov_2hlfa71304.f[2]++;var role=(cov_2hlfa71304.s[9]++,{domainId:req.params.domainId,name:params.roleName,modified:new Date(),members:params.role.members,active:'active'});cov_2hlfa71304.s[10]++;viewUtils.populateRoleData(role);cov_2hlfa71304.s[11]++;res.render('rolerow',{layout:false,roles:[role]});}));},deleteRole:function(req,res){cov_2hlfa71304.f[3]++;var params=(cov_2hlfa71304.s[12]++,{domainName:req.params.domainId,roleName:req.params.role});cov_2hlfa71304.s[13]++;req.restClient.deleteRole(params,reqUtils.ajaxJsonHandler(res));},getRoleRow:function(req,res){cov_2hlfa71304.f[4]++;cov_2hlfa71304.s[14]++;pageUtils.initCommonData(req,res);var params=(cov_2hlfa71304.s[15]++,{domainName:req.params.domainId,roleName:req.params.role,expand:true,auditLog:true});cov_2hlfa71304.s[16]++;req.restClient.getRole(params,reqUtils.ajaxHtmlHandler(res,function(role){cov_2hlfa71304.f[5]++;cov_2hlfa71304.s[17]++;role.active='active';cov_2hlfa71304.s[18]++;role.domainId=req.params.domainId;cov_2hlfa71304.s[19]++;viewUtils.populateRoleData(role);cov_2hlfa71304.s[20]++;res.render('rolerow',{layout:false,roles:[role]});}));}};